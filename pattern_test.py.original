import urllib2, base64, urllib

def testProvisioning():
    url = 'https://patro-kersrv2.tivlab.raleigh.ibm.com/resources/instances?'
    json = {"parts": [{"description": "RHEL63", "memberCount": 1, "key": "RHEL632", "partType": "OS Node", "partVersion": "1.0.0", "partCaption": "RHEL63", "label": "RHEL63", "id": 1, "resid": 1, "partDescriptiveName": null, "elasticDisabled": false, "elastic": true, "renderColor": null, "renderBackgroundImage": null, "renderConfigScriptColor": null, "renderIcon": null, "renderListIcon": null, "requiresAdvancedFunctionEnabled": false, "supportsIPv6": false, "hypervisorType": "OpenStack", "properties": [{"description": "PartType.Description", "label": "PartType.Label", "id": "1", "key": "PartType", "value": "OS Node", "pclass": "PartInformation", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": true, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "PartVersion.Description", "label": "PartVersion.Label", "id": "2", "key": "PartVersion", "value": "1.0.0", "pclass": "PartInformation", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": true, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "Build.Description", "label": "Build.Label", "id": "3", "key": "Build", "value": "", "pclass": "PartInformation", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": true, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "OS.Description", "label": "OS.Label", "id": "4", "key": "OS", "value": "rhel 6.3", "pclass": "PartInformation", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": true, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "Hypervisor.Description", "label": "Hypervisor.Label", "id": "5", "key": "Hypervisor", "value": "OpenStack", "pclass": "PartInformation", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": true, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "numvcpus.Description", "label": "numvcpus.Label", "id": "6", "key": "numvcpus", "value": "1", "pclass": "HWAttributes", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": true, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "memsize.Description", "label": "memsize.Label", "id": "7", "key": "memsize", "value": "512", "pclass": "HWAttributes", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": true, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "The boot protocol of the network adapter which determines how the IP address is set. (DHCP or Static)", "label": "Boot Protocol", "id": "8", "key": "bootproto", "value": "", "pclass": "ConfigNET", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": false, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "If using static boot protocol this is the gateway of the system", "label": "Gateway", "id": "9", "key": "gateway", "value": "", "pclass": "ConfigNET", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": false, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "The domain of the system", "label": "Domain", "id": "10", "key": "domain", "value": "", "pclass": "ConfigNET", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": false, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "The host name of the system", "label": "Host Name", "id": "11", "key": "hostname", "value": "", "pclass": "ConfigNET", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": false, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "If using static boot protocol this is the IP Address of the system", "label": "IP Address", "id": "12", "key": "ipaddr", "value": "", "pclass": "ConfigNET", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": false, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "If using static boot protocol this is the netmask of the system", "label": "Netmask", "id": "13", "key": "netmask", "value": "", "pclass": "ConfigNET", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": false, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "If using static boot protocol this is the primary DNS for the system", "label": "Primary DNS Server", "id": "14", "key": "pri_dns", "value": "", "pclass": "ConfigNET", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": false, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "If using static boot protocol this is the secondary DNS for the system", "label": "Secondary DNS Server", "id": "15", "key": "sec_dns", "value": "", "pclass": "ConfigNET", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": false, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "User name for SSH access to the node", "label": "SSH Username", "id": "16", "key": "username", "value": "", "pclass": "ConfigSSH", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": false, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "SSH key for access to the node", "label": "SSH Key", "id": "17", "key": "ssh_key", "value": "", "pclass": "ConfigSSH", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": false, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "Provide your own SSH public key for access to the node", "label": "SSH public key", "id": "18", "key": "user_ssh_key", "value": "", "pclass": "ConfigSSH", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": false, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "This is the username for the root account", "label": "Root username", "id": "19", "key": "username", "value": "root", "pclass": "ConfigPWD_ROOT", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": false, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "This is the Administrator password for the system", "label": "Administrator Password", "id": "20", "key": "password", "value": "password", "pclass": "ConfigPWD_ROOT", "instance": "1", "propDescriptiveName": null, "locked": "false", "userConfigurable": "true", "requiredForDeployment": true, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "This is the Administrator password for the system", "label": "Administrator Password encrypted", "id": "21", "key": "pwdencrypted", "value": "false", "pclass": "ConfigPWD_ROOT", "instance": "1", "propDescriptiveName": null, "locked": "true", "userConfigurable": "false", "requiredForDeployment": false, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}, {"description": "The user-data for virtual machine", "label": "User Data", "id": "22", "key": "userdata", "value": "", "pclass": "ConfigUserdata", "instance": "1", "propDescriptiveName": null, "locked": "false", "userConfigurable": "true", "requiredForDeployment": false, "propSrc": null, "propSrcImmediate": null, "type": "string", "password": false}], "startuporder": 0, "links": [], "orderingConstraintlinks": [], "possibleLinks": [], "constraints": [{"label": null, "virtualImageEditionId": "1", "type": "VirtualImageEditionIdConstraint", "name": "VirtualImageEditionIdConstraint"}], "templateid": 1, "virtualSystemId": "dbaf22af-b003-42fa-98fb-4176d4027a69#", "conceptualKey": "RHEL63", "validation": [{"status": "RM01001", "message": "RM06050"}], "scripts": [], "flavorid": "1", "cloudid": "1", "addresses": [[{"ipgroupid": "1"}]]}], "path": null, "created": 1372789601561, "name": "xxx", "currentstatus": "RM01027", "validationstatus": "RM01001", "ownerid": 2, "currentmessage": null, "validationmessage": "RM06000", "constraints": [], "validation": [{"status": "RM01001", "message": "RM06000"}], "id": 2, "updated": 1372789757678, "counter": 0, "description": null, "patternid": 2, "iptype": "IPv4", "environmentprofileid": 1}
    encoded = urllib.urlencode(json)
    print "encoded: ", encoded
    request = urllib2.Request(url + encoded)
    string = base64.encodestring('admin:password')
    request.add_header ("Authorization", "Basic %s" % string)
    request.add_header ("Content-Type", "application/json;charset=UTF-8")
    request.add_header ("X-IBM-Workload-Deployer-API-Version", "3.0")
    response = urllib2.urlopen(request)
    print "response: ", response.read()
    assert False
